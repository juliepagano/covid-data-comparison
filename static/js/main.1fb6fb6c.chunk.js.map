{"version":3,"sources":["services/covidTrackingService.tsx","components/SquareChart.tsx","components/ScaleChart.tsx","components/DataCharts.tsx","components/DataContainer.tsx","components/ControlBar.tsx","components/App.tsx","components/Routes.tsx","reportWebVitals.ts","index.tsx"],"names":["BASE_URL","getUSDataByDate","date","a","formattedDate","formatDate","axios","get","getLatestUSData","currentDate","Date","res","response","status","subDays","data","Error","getStateDataByDate","state","toLowerCase","getLatestStateData","getStateMetadata","BOXES_IN_GROUP","BOXES_IN_SECTION","SquareChart","startX","startY","label","value","source","scaleValue","color","highlight","minWidth","maxWidth","boxCount","Math","ceil","maxSectionsWide","floor","BOX_STROKE_WIDTH","GROUP_PADDING","sectionCount","sectionColumns","min","sectionRows","calculatedChartHeight","calculatedChartWidth","renderBoxes","startBoxIndex","Array","map","e","boxRow","boxY","boxCol","boxX","boxIndex","max","fill","fillOpacity","stroke","strokeWidth","width","height","x","y","data-box-key","renderGroups","groupRow","groupY","groupCol","groupX","groupBoxIndex","sections","sectionRow","sectionY","sectionCol","sectionX","sectionBoxIndex","className","style","cx","numbro","format","thousandSeparated","mantissa","href","ScaleChart","entries","scale","isCovid","otherEntry","dataType","DataCharts","chartScales","length","COVID_ENTRIES","dataKey","IMPACT_SCALES","reversedImpactScales","reverse","DataContainer","showStates","showUS","useState","setChartScales","filteredChartScales","setFilteredChartScales","useEffect","scaleMap","reduce","result","set","Map","usResult","forEach","matchingScale","find","stateMeta","Promise","all","state_code","stateResult","newChartScales","otherScale","combinedEntries","sort","b","fetchData","allowedDataTypes","push","newFilteredChartScales","filter","includes","ControlBar","history","useHistory","location","useLocation","type","onClick","query","qs","parse","search","ignoreQueryPrefix","currentTarget","checked","toString","pathname","stringify","App","setShowStates","setShowUS","queryString","Routes","path","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.1fb6fb6c.chunk.js","sourcesContent":["import axios from \"axios\";\nimport formatDate from \"date-fns/format\";\nimport subDays from \"date-fns/subDays\";\n\nconst BASE_URL = \"https://api.covidtracking.com/v2beta\";\n\nasync function getUSDataByDate(date: Date) {\n  const formattedDate = formatDate(date, \"yyyy-MM-dd\");\n  return axios.get(`${BASE_URL}/us/daily/${formattedDate}.json`);\n}\n\nexport async function getLatestUSData() {\n  const currentDate = new Date();\n\n  let res;\n  try {\n    // Try today\n    res = await getUSDataByDate(currentDate);\n  } catch (e) {\n    if (e?.response?.status === 404) {\n      // Try yesterday if today is not ready yet\n      try {\n        res = await getUSDataByDate(subDays(currentDate, 1));\n      } catch (e) {\n        // do something\n      }\n    }\n  }\n\n  if (res?.data?.data) {\n    return res?.data?.data;\n  }\n\n  throw new Error(\"Unable to load latest US data.\");\n}\n\nasync function getStateDataByDate(state: string, date: Date) {\n  const formattedDate = formatDate(date, \"yyyy-MM-dd\");\n  return axios.get(\n    `${BASE_URL}/states/${state.toLowerCase()}/${formattedDate}.json`\n  );\n}\n\nexport async function getLatestStateData(state: string) {\n  const currentDate = new Date();\n\n  let res;\n  try {\n    // Try today\n    res = await getStateDataByDate(state, currentDate);\n  } catch (e) {\n    if (e?.response?.status === 404) {\n      // Try yesterday if today is not ready yet\n      try {\n        res = await getStateDataByDate(state, subDays(currentDate, 1));\n      } catch (e) {\n        // do something\n      }\n    }\n  }\n\n  if (res?.data?.data) {\n    return res?.data?.data;\n  }\n\n  throw new Error(`Unable to load latest ${state} data.`);\n}\n\nexport async function getStateMetadata() {\n  let res;\n  try {\n    res = await axios.get(`${BASE_URL}/states.json`);\n  } catch (e) {\n    // Something went wrong\n  }\n\n  if (res?.data?.data) {\n    return res?.data?.data;\n  }\n\n  throw new Error(\"Unable to load state metadata.\");\n}\n","import React, { Fragment } from \"react\";\nimport numbro from \"numbro\";\nimport cx from \"classnames\";\n\nimport \"./SquareChart.scss\";\n\ninterface SquareChartProps {\n  label: string;\n  value: number;\n  source?: string;\n  scaleValue: number;\n  color?: string;\n  highlight?: boolean;\n  minWidth?: number;\n  maxWidth?: number;\n}\n\n// Box size in pixels\nconst BOX_SIZE_PX = 8;\nconst BOX_PADDING = 3;\nconst BOX_STROKE_WIDTH = 1;\n\n// Group size in number of boxes\nconst GROUP_SIZE = 5;\nconst BOXES_IN_GROUP = GROUP_SIZE ** 2;\nconst GROUP_PADDING = BOX_PADDING * 2;\nconst GROUP_SIZE_PX = BOX_SIZE_PX * GROUP_SIZE + BOX_PADDING * (GROUP_SIZE - 1);\n\n// Section size in number of groups\nconst SECTION_SIZE = 2;\nconst GROUPS_IN_SECTION = SECTION_SIZE ** 2;\nconst BOXES_IN_SECTION = GROUPS_IN_SECTION * BOXES_IN_GROUP;\nconst SECTION_PADDING = GROUP_PADDING * 2;\nconst SECTION_SIZE_PX =\n  GROUP_SIZE_PX * SECTION_SIZE + GROUP_PADDING * (SECTION_SIZE - 1);\n\nfunction SquareChart({\n  label,\n  value,\n  source,\n  scaleValue,\n  color,\n  highlight,\n  minWidth = 250,\n  maxWidth = 500,\n}: SquareChartProps) {\n  const boxCount = Math.ceil(value / scaleValue);\n  const maxSectionsWide = Math.floor(\n    (maxWidth - BOX_STROKE_WIDTH * 2 + SECTION_PADDING) /\n      (SECTION_SIZE_PX + SECTION_PADDING)\n  );\n\n  const sectionCount = Math.ceil(boxCount / BOXES_IN_SECTION);\n  const sectionColumns = Math.min(maxSectionsWide, sectionCount);\n  const sectionRows = Math.ceil(sectionCount / sectionColumns);\n\n  // const chartWidth =\n  //   sectionColumns * SECTION_SIZE_PX +\n  //   SECTION_PADDING * (sectionColumns - 1) +\n  //   BOX_STROKE_WIDTH * 2;\n\n  // const chartHeight =\n  //   sectionRows * SECTION_SIZE_PX +\n  //   SECTION_PADDING * (sectionRows - 1) +\n  //   BOX_STROKE_WIDTH * 2;\n\n  let calculatedChartHeight = 0;\n  let calculatedChartWidth = 0;\n\n  const renderBoxes = (\n    startX: number,\n    startY: number,\n    startBoxIndex: number,\n    boxCount: number\n  ) => {\n    return [...Array(GROUP_SIZE)].map((e, boxRow) => {\n      const boxY = startY + boxRow * (BOX_SIZE_PX + BOX_PADDING);\n\n      return [...Array(GROUP_SIZE)].map((e, boxCol) => {\n        const boxX = startX + boxCol * (BOX_SIZE_PX + BOX_PADDING);\n        const boxIndex = startBoxIndex + boxRow * GROUP_SIZE + boxCol;\n\n        if (boxIndex >= boxCount) {\n          return null;\n        }\n\n        calculatedChartHeight = boxY + BOX_SIZE_PX + BOX_STROKE_WIDTH;\n        calculatedChartWidth = Math.max(\n          boxX + BOX_SIZE_PX + BOX_STROKE_WIDTH,\n          calculatedChartWidth\n        );\n\n        return (\n          <Fragment key={boxIndex}>\n            <rect\n              fill={color}\n              fillOpacity={0.5}\n              stroke=\"#000\"\n              strokeWidth={BOX_STROKE_WIDTH}\n              width={BOX_SIZE_PX}\n              height={BOX_SIZE_PX}\n              x={boxX}\n              y={boxY}\n              data-box-key={boxIndex}\n            />\n          </Fragment>\n        );\n      });\n    });\n  };\n\n  const renderGroups = (\n    startX: number,\n    startY: number,\n    startBoxIndex: number,\n    boxCount: number\n  ) => {\n    return [...Array(SECTION_SIZE)].map((e, groupRow) => {\n      const groupY = startY + groupRow * (GROUP_SIZE_PX + GROUP_PADDING);\n\n      return [...Array(SECTION_SIZE)].map((e, groupCol) => {\n        const groupX = startX + groupCol * (GROUP_SIZE_PX + GROUP_PADDING);\n        const groupBoxIndex =\n          startBoxIndex + (groupRow * SECTION_SIZE + groupCol) * BOXES_IN_GROUP;\n\n        if (groupBoxIndex >= boxCount) {\n          return null;\n        }\n\n        return (\n          <Fragment key={groupBoxIndex}>\n            {/* <rect\n              fill=\"none\"\n              width={GROUP_SIZE_PX}\n              height={GROUP_SIZE_PX}\n              x={groupX}\n              y={groupY}\n              data-group-key={groupBoxIndex}\n            /> */}\n            {renderBoxes(groupX, groupY, groupBoxIndex, boxCount)}\n          </Fragment>\n        );\n      });\n    });\n  };\n\n  const renderSections = (startX: number, startY: number) => {\n    return [...Array(sectionRows)].map((e, sectionRow) => {\n      const sectionY =\n        startY + sectionRow * (SECTION_SIZE_PX + SECTION_PADDING);\n\n      return [...Array(sectionColumns)].map((e, sectionCol) => {\n        const sectionX =\n          startX + sectionCol * (SECTION_SIZE_PX + SECTION_PADDING);\n        const sectionBoxIndex =\n          (sectionRow * sectionColumns + sectionCol) * BOXES_IN_SECTION;\n\n        if (sectionBoxIndex >= boxCount) {\n          return null;\n        }\n\n        return (\n          <Fragment key={sectionBoxIndex}>\n            {/* <rect\n              fill=\"none\"\n              width={SECTION_SIZE_PX}\n              height={SECTION_SIZE_PX}\n              x={sectionX}\n              y={sectionY}\n              data-section-key={sectionBoxIndex}\n            /> */}\n            {renderGroups(sectionX, sectionY, sectionBoxIndex, boxCount)}\n          </Fragment>\n        );\n      });\n    });\n  };\n\n  const sections = renderSections(BOX_STROKE_WIDTH, BOX_STROKE_WIDTH);\n\n  return (\n    <figure className=\"SquareChart\" style={{ minWidth }}>\n      <figcaption>\n        <span className={cx({ highlight: highlight })}>\n          {label} (\n          {numbro(value).format({\n            thousandSeparated: true,\n            mantissa: 0,\n          })}\n          ){\" \"}\n        </span>\n        {source && (\n          <span className=\"SquareChart-source\">\n            [<a href={source}>source</a>]\n          </span>\n        )}\n      </figcaption>\n      <svg width={calculatedChartWidth} height={calculatedChartHeight}>\n        {sections}\n      </svg>\n    </figure>\n  );\n}\n\nexport default SquareChart;\n","import React from \"react\";\nimport SquareChart from \"./SquareChart\";\nimport numbro from \"numbro\";\n\nimport \"./ScaleChart.scss\";\n\ntype ScaleChartProps = ImpactScale;\n\nconst ScaleChart = ({ entries, scale, color }: ScaleChartProps) => {\n  return (\n    <section className=\"ScaleChart\">\n      <h2>\n        {numbro(scale).format({\n          thousandSeparated: true,\n          mantissa: 0,\n        })}\n      </h2>\n      {entries.map(({ label, isCovid, dataType, ...otherEntry }) => {\n        return (\n          <SquareChart\n            key={label}\n            label={label}\n            scaleValue={scale}\n            color={color}\n            highlight={isCovid}\n            {...otherEntry}\n          />\n        );\n      })}\n    </section>\n  );\n};\n\nexport default ScaleChart;\n","import React from \"react\";\nimport ScaleChart from \"./ScaleChart\";\n\nimport \"./DataCharts.scss\";\n\ninterface DataChartsProps {\n  chartScales: ImpactScale[];\n}\n\nconst DataCharts = ({ chartScales }: DataChartsProps) => {\n  return (\n    <div className=\"DataCharts\">\n      {chartScales.map(({ color, scale, entries }) => {\n        if (!entries.length) {\n          return null;\n        }\n\n        return (\n          <ScaleChart\n            key={scale}\n            color={color}\n            scale={scale}\n            entries={entries}\n          />\n        );\n      })}\n    </div>\n  );\n};\nexport default DataCharts;\n","import React, { useEffect, useState } from \"react\";\nimport {\n  getLatestUSData,\n  getStateMetadata,\n  getLatestStateData,\n} from \"../services/covidTrackingService\";\nimport get from \"lodash.get\";\nimport DataCharts from \"./DataCharts\";\n\nconst COVID_ENTRIES = [\n  {\n    label: \"Total deaths from Covid\",\n    dataKey: \"outcomes.death.total.value\",\n  },\n  {\n    label: \"Today's deaths from Covid\",\n    dataKey: \"outcomes.death.total.calculated.change_from_prior_day\",\n  },\n];\n\nconst IMPACT_SCALES: ImpactScale[] = [\n  {\n    color: \"green\",\n    scale: 1,\n    entries: [],\n  },\n  {\n    color: \"blue\",\n    scale: 10,\n    entries: [\n      {\n        label: \"Oklahoma City Bombings\",\n        value: 168,\n      },\n      {\n        label: \"Jonestown\",\n        value: 918,\n      },\n      { label: \"Columbine\", value: 15 },\n      {\n        label: \"Waco siege\",\n        value: 86,\n      },\n    ],\n  },\n  // {\n  //   color: \"#f5e751\",\n  //   scale: 100,\n  //   entries: [\n  //     {\n  //       label: \"Oklahoma City Bombings\",\n  //       value: 168,\n  //     },\n  //     {\n  //       label: \"Jonestown\",\n  //       value: 918,\n  //     },\n  //   ],\n  // },\n  {\n    color: \"orange\",\n    scale: 1000,\n    entries: [\n      {\n        label: \"US deaths in Vietnam War\",\n        value: 58209,\n      },\n      {\n        label: \"US motor vehicle traffic deaths in 2019\",\n        value: 37595,\n      },\n      {\n        label: \"9/11\",\n        value: 2996,\n      },\n      {\n        label: \"Deaths from flu and pneumonia in 2019\",\n        value: 49783,\n      },\n      {\n        label: \"Deaths from homicide in 2019\",\n        value: 19141,\n      },\n      {\n        label: \"Attack on Pearl Harbor\",\n        value: 2467,\n      },\n      {\n        label: \"Hurricane Katrina\",\n        value: 1833,\n      },\n      {\n        label: \"US deaths in Iraq War\",\n        value: 4497,\n      },\n    ],\n  },\n  // {\n  //   color: \"red\",\n  //   scale: 10000,\n  //   entries: [],\n  // },\n  {\n    color: \"black\",\n    scale: 100000,\n    entries: [\n      {\n        label: \"HIV/AIDS in the US as of 2018\",\n        value: 700000,\n      },\n      {\n        label: \"1918 Spanish Flu in the US\",\n        value: 675000,\n      },\n      {\n        label: \"Deaths in US Civil War\",\n        value: 655000,\n      },\n      {\n        label: \"US deaths in WWII\",\n        value: 405399,\n      },\n      {\n        label: \"US deaths in WWI\",\n        value: 116516,\n      },\n      {\n        label: \"Unintentional injury deaths in 2019\",\n        value: 173040,\n      },\n    ],\n  },\n];\n\nconst reversedImpactScales = [...IMPACT_SCALES].reverse();\n\ninterface DataContainerProps {\n  showStates: boolean;\n  showUS: boolean;\n}\n\nfunction DataContainer({ showStates, showUS }: DataContainerProps) {\n  const [chartScales, setChartScales] = useState<ImpactScale[]>();\n  const [filteredChartScales, setFilteredChartScales] = useState<\n    ImpactScale[]\n  >();\n\n  useEffect(() => {\n    async function fetchData() {\n      const scaleMap = IMPACT_SCALES.reduce((result, { scale }) => {\n        result.set(scale, []);\n        return result;\n      }, new Map());\n\n      try {\n        const usResult = await getLatestUSData();\n\n        COVID_ENTRIES.forEach(({ label, dataKey }) => {\n          const value = get(usResult, dataKey);\n\n          if (typeof value === \"number\") {\n            const matchingScale = reversedImpactScales.find(\n              (scale) => value >= scale.scale\n            );\n            if (matchingScale) {\n              scaleMap.set(matchingScale.scale, [\n                ...scaleMap.get(matchingScale.scale),\n                {\n                  label: `US: ${label}`,\n                  value: value,\n                  isCovid: true,\n                  dataType: \"US_COVID\",\n                  source: \"https://covidtracking.com/\",\n                },\n              ]);\n            }\n          }\n        });\n      } catch (e) {\n        // error\n      }\n\n      try {\n        const stateMeta = await getStateMetadata();\n\n        const stateResults = await Promise.all(\n          stateMeta.map(({ state_code }: { state_code: string }) => {\n            return getLatestStateData(state_code);\n          })\n        );\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        stateResults.forEach((stateResult: any) => {\n          const state: string = stateResult.state;\n\n          COVID_ENTRIES.forEach(({ label, dataKey }) => {\n            const value = get(stateResult, dataKey);\n\n            if (typeof value === \"number\") {\n              const matchingScale = reversedImpactScales.find(\n                (scale) => value >= scale.scale\n              );\n              if (matchingScale) {\n                scaleMap.set(matchingScale.scale, [\n                  ...scaleMap.get(matchingScale.scale),\n                  {\n                    label: `${state}: ${label}`,\n                    value: value,\n                    isCovid: true,\n                    dataType: \"STATE_COVID\",\n                    source: \"https://covidtracking.com/\",\n                  },\n                ]);\n              }\n            }\n          });\n        });\n      } catch (e) {\n        // error\n      }\n\n      const newChartScales = IMPACT_SCALES.map(\n        ({ entries, scale, ...otherScale }) => {\n          const combinedEntries = [...entries, ...scaleMap.get(scale)].sort(\n            (a, b) => a.value - b.value\n          );\n\n          return {\n            ...otherScale,\n            scale,\n            entries: combinedEntries,\n          };\n        }\n      );\n      setChartScales(newChartScales);\n    }\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    if (!chartScales) {\n      return;\n    }\n\n    const allowedDataTypes: ChartEntry[\"dataType\"][] = [\"OTHER\"];\n    if (showStates) {\n      allowedDataTypes.push(\"STATE_COVID\");\n    }\n    if (showUS) {\n      allowedDataTypes.push(\"US_COVID\");\n    }\n\n    const newFilteredChartScales = chartScales.map(\n      ({ entries, ...otherScale }) => {\n        return {\n          ...otherScale,\n          entries: entries.filter(({ dataType = \"OTHER\" }) => {\n            return allowedDataTypes.includes(dataType);\n          }),\n        };\n      }\n    );\n    setFilteredChartScales(newFilteredChartScales);\n  }, [chartScales, showStates, showUS]);\n\n  if (!filteredChartScales) {\n    return null;\n  }\n\n  return <DataCharts chartScales={filteredChartScales} />;\n}\n\nexport default DataContainer;\n","import React from \"react\";\nimport { useHistory, useLocation } from \"react-router-dom\";\nimport qs from \"qs\";\n\nimport \"./ControlBar.scss\";\n\nconst ControlBar = () => {\n  const history = useHistory();\n  const location = useLocation();\n\n  const onClickShowStates: React.FormEventHandler<HTMLInputElement> = (e) => {\n    const query = qs.parse(location.search, { ignoreQueryPrefix: true });\n    query.showStates = e.currentTarget.checked.toString();\n\n    history.push({\n      pathname: location.pathname,\n      search: qs.stringify(query),\n    });\n  };\n\n  const onClickShowUS: React.FormEventHandler<HTMLInputElement> = (e) => {\n    const query = qs.parse(location.search, { ignoreQueryPrefix: true });\n    query.showUS = e.currentTarget.checked.toString();\n\n    history.push({\n      pathname: location.pathname,\n      search: qs.stringify(query),\n    });\n  };\n\n  return (\n    <header className=\"ControlBar\">\n      <label>\n        State Covid Data\n        <input type=\"checkbox\" onClick={onClickShowStates} />\n      </label>\n      <label>\n        US Covid Data\n        <input type=\"checkbox\" onClick={onClickShowUS} />\n      </label>\n    </header>\n  );\n};\nexport default ControlBar;\n","import React, { useEffect, useState } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport DataContainer from \"./DataContainer\";\nimport ControlBar from \"./ControlBar\";\nimport qs from \"qs\";\n\nimport \"./App.scss\";\n\nfunction App() {\n  const location = useLocation();\n\n  const [showStates, setShowStates] = useState(false);\n  const [showUS, setShowUS] = useState(false);\n\n  useEffect(() => {\n    const queryString = qs.parse(location.search, { ignoreQueryPrefix: true });\n    setShowStates(queryString.showStates === \"true\");\n    setShowUS(queryString.showUS === \"true\");\n  }, [location]);\n\n  return (\n    <div className=\"App\">\n      <ControlBar />\n      <div className=\"App-content\">\n        <DataContainer showStates={showStates} showUS={showUS} />\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport { BrowserRouter as Router, Route } from \"react-router-dom\";\nimport App from \"./App\";\n\nconst Routes = () => {\n  return (\n    <Router>\n      <Route path=\"/\">\n        <App />\n      </Route>\n    </Router>\n  );\n};\nexport default Routes;\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.scss\";\nimport Routes from \"./components/Routes\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Routes />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}